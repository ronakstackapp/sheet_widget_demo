import 'dart:convert';
import 'dart:io';
import 'dart:typed_data';
import 'package:flutter/material.dart';
import 'package:fluttertoast/fluttertoast.dart';
import 'package:image_gallery_saver/image_gallery_saver.dart';
import 'package:path_provider/path_provider.dart';
import 'package:permission_handler/permission_handler.dart';
import 'package:sheet_widget_demo/utils/color.dart';

class SaveImageGalleryPage extends StatefulWidget {
  const SaveImageGalleryPage({Key key}) : super(key: key);

  @override
  _SaveImageGalleryPageState createState() => _SaveImageGalleryPageState();
}

class _SaveImageGalleryPageState extends State<SaveImageGalleryPage> {
  var encodedStr =
      "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";
  Uint8List bytes;

  @override
  void initState() {
    bytes = base64.decode(encodedStr);
    _requestPermission();
    super.initState();
  }

  @override
  Widget build(BuildContext context) {
    print("currant page-->$runtimeType");
    return Scaffold(
      appBar: AppBar(
        title: Text("save image in gallery"),
      ),
      body: Padding(
        padding: EdgeInsets.only(top: 150.0),
        child: Column(
          children: [
            Container(
              child: Image.asset("images/smile.jpg"),
            ),
            Center(
              child: MaterialButton(
                color: themeColor,
                minWidth: 20,
                onPressed: () {
                  setState(() {
                    _createFileFromString();
                  });
                },
                child: Text("Save image in gallery"),
              ),
            ),
          ],
        ),
      ),
    );
  }

  _createFileFromString() async {
    String dir = (await getApplicationDocumentsDirectory()).path;
    String fullPath = '$dir/abc.png';
    print("+++=local file full path $fullPath");
    File file = File(fullPath);
    await file.writeAsBytes(bytes);
    print(file.path);
    final result = await ImageGallerySaver.saveImage(bytes);
    _toastInfo("Image Download SuccessFully");
    print(result);
    return file.path;
  }

  _requestPermission() async {
    Map<Permission, PermissionStatus> statuses = await [
      Permission.storage,
    ].request();

    final info = statuses[Permission.storage].toString();
    print(info);
    _toastInfo(info);
  }

  _toastInfo(String info) {
    Fluttertoast.showToast(msg: info, toastLength: Toast.LENGTH_LONG);
  }
}
